{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/auth/auth.service\";\nimport * as i2 from \"../service/token/token-storage.service\";\nfunction LoginComponent_form_3_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1, \" Login is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_13_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Password is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_13_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Password must be at least 6 characters \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, LoginComponent_form_3_div_13_div_1_Template, 2, 0, \"div\", 17);\n    i0.ɵɵtemplate(2, LoginComponent_form_3_div_13_div_2_Template, 2, 0, \"div\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r5 = i0.ɵɵreference(12);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r5.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r5.errors.minlength);\n  }\n}\nfunction LoginComponent_form_3_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Login failed: \", ctx_r7.errorMessage, \" \");\n  }\n}\nfunction LoginComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 5, 6);\n    i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_form_3_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const _r2 = i0.ɵɵreference(1);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(_r2.form.valid && ctx_r10.onSubmit());\n    });\n    i0.ɵɵelementStart(2, \"div\", 7)(3, \"label\", 8);\n    i0.ɵɵtext(4, \"Login\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"input\", 9, 10);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_3_Template_input_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.form.login = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, LoginComponent_form_3_div_7_Template, 2, 0, \"div\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 7)(9, \"label\", 12);\n    i0.ɵɵtext(10, \"Password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 13, 14);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_3_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.form.password = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, LoginComponent_form_3_div_13_Template, 3, 2, \"div\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 7)(15, \"button\", 15);\n    i0.ɵɵtext(16, \" Login \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 7);\n    i0.ɵɵtemplate(18, LoginComponent_form_3_div_18_Template, 2, 1, \"div\", 11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const _r2 = i0.ɵɵreference(1);\n    const _r3 = i0.ɵɵreference(6);\n    const _r5 = i0.ɵɵreference(12);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.login);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r3.errors && _r2.submitted);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.password);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r5.errors && _r2.submitted);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", _r2.submitted && ctx_r0.isLoginFailed);\n  }\n}\nfunction LoginComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Logged in as \", ctx_r1.role, \". \");\n  }\n}\nexport class LoginComponent {\n  constructor(authService, tokenStorage) {\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.form = {\n      login: null,\n      password: null\n    };\n    this.authenticate = false;\n    this.isLoginFailed = false;\n    this.errorMessage = '';\n    this.role = '';\n  }\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.authenticate = true;\n      this.role = this.tokenStorage.getUser().role;\n    }\n  }\n  onSubmit() {\n    const {\n      login,\n      password\n    } = this.form;\n    this.authService.login(login, password).subscribe(data => {\n      this.tokenStorage.saveToken(data.token);\n      this.tokenStorage.saveUser(data);\n      this.isLoginFailed = false;\n      this.authenticate = true;\n      this.role = this.tokenStorage.getUser().role;\n      this.reloadPage();\n    }, err => {\n      debugger;\n      this.errorMessage = err.error.message;\n      this.isLoginFailed = true;\n    });\n  }\n  reloadPage() {\n    window.location.reload();\n  }\n  static #_ = this.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.TokenStorageService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    decls: 5,\n    vars: 2,\n    consts: [[1, \"col-md-12\"], [1, \"card\", \"card-container\"], [\"id\", \"profile-img\", \"src\", \"//ssl.gstatic.com/accounts/ui/avatar_2x.png\", 1, \"profile-img-card\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\", 4, \"ngIf\"], [\"class\", \"alert alert-success\", 4, \"ngIf\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\"], [\"f\", \"ngForm\"], [1, \"form-group\"], [\"for\", \"login\"], [\"type\", \"text\", \"name\", \"login\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"login\", \"ngModel\"], [\"class\", \"alert alert-danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"for\", \"password\"], [\"type\", \"password\", \"name\", \"password\", \"required\", \"\", \"minlength\", \"6\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"password\", \"ngModel\"], [1, \"btn\", \"btn-primary\", \"btn-block\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\"], [4, \"ngIf\"], [1, \"alert\", \"alert-success\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"img\", 2);\n        i0.ɵɵtemplate(3, LoginComponent_form_3_Template, 19, 5, \"form\", 3);\n        i0.ɵɵtemplate(4, LoginComponent_div_4_Template, 2, 1, \"div\", 4);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.authenticate);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.authenticate);\n      }\n    },\n    styles: [\".col-md-12[_ngcontent-%COMP%] {\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n  display: flex;\\r\\n}\\r\\n\\r\\n.card-container[_ngcontent-%COMP%] {\\r\\n  padding: 30px 30px 10px 30px;\\r\\n  margin-top: 20px;\\r\\n  width: 350px;\\r\\n}\\r\\n\\r\\n.profile-img-card[_ngcontent-%COMP%] {\\r\\n  width: 198px;\\r\\n  align-self: center;\\r\\n  margin-bottom: 20px;\\r\\n}\\n/*# sourceURL=webpack://./src/app/login/login.component.css */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbG9naW4vbG9naW4uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLG1CQUFtQjtFQUNuQix1QkFBdUI7RUFDdkIsYUFBYTtBQUNmOztBQUVBO0VBQ0UsNEJBQTRCO0VBQzVCLGdCQUFnQjtFQUNoQixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLG1CQUFtQjtBQUNyQiIsInNvdXJjZXNDb250ZW50IjpbIi5jb2wtbWQtMTIge1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgZGlzcGxheTogZmxleDtcclxufVxyXG5cclxuLmNhcmQtY29udGFpbmVyIHtcclxuICBwYWRkaW5nOiAzMHB4IDMwcHggMTBweCAzMHB4O1xyXG4gIG1hcmdpbi10b3A6IDIwcHg7XHJcbiAgd2lkdGg6IDM1MHB4O1xyXG59XHJcblxyXG4ucHJvZmlsZS1pbWctY2FyZCB7XHJcbiAgd2lkdGg6IDE5OHB4O1xyXG4gIGFsaWduLXNlbGY6IGNlbnRlcjtcclxuICBtYXJnaW4tYm90dG9tOiAyMHB4O1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"mappings":";;;;;IAoBQA,+BAIC;IACCA,mCACF;IAAAA,iBAAM;;;;;IAkBJA,2BAAsC;IAAAA,oCAAoB;IAAAA,iBAAM;;;;;IAChEA,2BAAuC;IACrCA,wDACF;IAAAA,iBAAM;;;;;IARRA,+BAIC;IACCA,8EAAgE;IAChEA,8EAEM;IACRA,iBAAM;;;;;IAJEA,eAA8B;IAA9BA,0CAA8B;IAC9BA,eAA+B;IAA/BA,2CAA+B;;;;;IAWvCA,+BAIC;IACCA,YACF;IAAAA,iBAAM;;;;IADJA,eACF;IADEA,kEACF;;;;;;IA3DJA,kCAMC;IAHCA;MAAAA;MAAA;MAAA;MAAA,OAAYA,iCAAgBC,kBAAU;IAAA,EAAC;IAIvCD,8BAAwB;IACHA,qBAAK;IAAAA,iBAAQ;IAChCA,oCAOE;IAHAA;MAAAA;MAAA;MAAA,OAAaA,2CACjB;IAAA,EAD4B;IAJ1BA,iBAOE;IACFA,uEAMM;IACRA,iBAAM;IACNA,8BAAwB;IACAA,yBAAQ;IAAAA,iBAAQ;IACtCA,sCAQE;IAJAA;MAAAA;MAAA;MAAA,OAAaA,8CACjB;IAAA,EAD+B;IAJ7BA,iBAQE;IACFA,yEASM;IACRA,iBAAM;IACNA,+BAAwB;IAEpBA,wBACF;IAAAA,iBAAS;IAEXA,+BAAwB;IACtBA,yEAMM;IACRA,iBAAM;;;;;;;IA/CFA,eAAwB;IAAxBA,2CAAwB;IAOvBA,eAAiC;IAAjCA,kDAAiC;IAWlCA,eAA2B;IAA3BA,8CAA2B;IAQ1BA,eAAoC;IAApCA,kDAAoC;IAiBpCA,eAAkC;IAAlCA,4DAAkC;;;;;IAOzCA,+BAAsD;IACpDA,YACF;IAAAA,iBAAM;;;;IADJA,eACF;IADEA,0DACF;;;AC3DJ,OAAM,MAAOE,cAAc;EAUzBC,YAAoBC,WAAwB,EAAUC,YAAiC;IAAnE,gBAAW,GAAXD,WAAW;IAAuB,iBAAY,GAAZC,YAAY;IATlE,SAAI,GAAQ;MACVC,KAAK,EAAE,IAAI;MACXC,QAAQ,EAAE;KACX;IACD,iBAAY,GAAG,KAAK;IACpB,kBAAa,GAAG,KAAK;IACrB,iBAAY,GAAG,EAAE;IACjB,SAAI,GAAW,EAAE;EAE0E;EAE3FC,QAAQ;IACN,IAAI,IAAI,CAACH,YAAY,CAACI,QAAQ,EAAE,EAAE;MAChC,IAAI,CAACC,YAAY,GAAG,IAAI;MACxB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACN,YAAY,CAACO,OAAO,EAAE,CAACD,IAAI;;EAEhD;EAEAE,QAAQ;IACN,MAAM;MAAEP,KAAK;MAAEC;IAAQ,CAAE,GAAG,IAAI,CAACO,IAAI;IAErC,IAAI,CAACV,WAAW,CAACE,KAAK,CAACA,KAAK,EAAEC,QAAQ,CAAC,CAACQ,SAAS,CAC5CC,IAAqB,IAAI;MAC1B,IAAI,CAACX,YAAY,CAACY,SAAS,CAACD,IAAI,CAACE,KAAK,CAAC;MACvC,IAAI,CAACb,YAAY,CAACc,QAAQ,CAACH,IAAI,CAAC;MAEhC,IAAI,CAACI,aAAa,GAAG,KAAK;MAC1B,IAAI,CAACV,YAAY,GAAG,IAAI;MACxB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACN,YAAY,CAACO,OAAO,EAAE,CAACD,IAAI;MAC5C,IAAI,CAACU,UAAU,EAAE;IACnB,CAAC,EACEC,GAAqC,IAAI;MAC1C;MACA,IAAI,CAACC,YAAY,GAAGD,GAAG,CAACE,KAAK,CAACC,OAAO;MACrC,IAAI,CAACL,aAAa,GAAG,IAAI;IAC3B,CAAC,CACF;EACH;EAEAC,UAAU;IACRK,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;EAC1B;EAAC;qBA1CU1B,cAAc;EAAA;EAAA;UAAdA,cAAc;IAAA2B;IAAAC;IAAAC;IAAAC;IAAAC;MAAA;QDT3BjC,8BAAuB;QAEnBA,yBAAmG;QACnGA,kEA6DO;QAEPA,+DAEM;QACRA,iBAAM;;;QAjEDA,eAAmB;QAAnBA,wCAAmB;QA8DYA,eAAkB;QAAlBA,uCAAkB","names":["i0","ctx_r10","LoginComponent","constructor","authService","tokenStorage","login","password","ngOnInit","getToken","authenticate","role","getUser","onSubmit","form","subscribe","data","saveToken","token","saveUser","isLoginFailed","reloadPage","err","errorMessage","error","message","window","location","reload","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Albion\\Desktop\\Magistratura\\third\\development-technology\\loan-offer\\client\\src\\app\\login\\login.component.html","C:\\Users\\Albion\\Desktop\\Magistratura\\third\\development-technology\\loan-offer\\client\\src\\app\\login\\login.component.ts"],"sourcesContent":["<div class=\"col-md-12\">\n  <div class=\"card card-container\">\n    <img id=\"profile-img\" src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\" class=\"profile-img-card\" />\n    <form\n      *ngIf=\"!authenticate\"\n      name=\"form\"\n      (ngSubmit)=\"f.form.valid && onSubmit()\"\n      #f=\"ngForm\"\n      novalidate\n    >\n      <div class=\"form-group\">\n        <label for=\"login\">Login</label>\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          name=\"login\"\n          [(ngModel)]=\"form.login\"\n          required\n          #login=\"ngModel\"\n        />\n        <div\n          class=\"alert alert-danger\"\n          role=\"alert\"\n          *ngIf=\"login.errors && f.submitted\"\n        >\n          Login is required\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"password\">Password</label>\n        <input\n          type=\"password\"\n          class=\"form-control\"\n          name=\"password\"\n          [(ngModel)]=\"form.password\"\n          required\n          minlength=\"6\"\n          #password=\"ngModel\"\n        />\n        <div\n          class=\"alert alert-danger\"\n          role=\"alert\"\n          *ngIf=\"password.errors && f.submitted\"\n        >\n          <div *ngIf=\"password.errors.required\">Password is required</div>\n          <div *ngIf=\"password.errors.minlength\">\n            Password must be at least 6 characters\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <button class=\"btn btn-primary btn-block\">\n          Login\n        </button>\n      </div>\n      <div class=\"form-group\">\n        <div\n          class=\"alert alert-danger\"\n          role=\"alert\"\n          *ngIf=\"f.submitted && isLoginFailed\"\n        >\n          Login failed: {{ errorMessage }}\n        </div>\n      </div>\n    </form>\n\n    <div class=\"alert alert-success\" *ngIf=\"authenticate\">\n      Logged in as {{ role }}.\n    </div>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { AuthService } from '../service/auth/auth.service';\nimport { TokenStorageService } from '../service/token/token-storage.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent implements OnInit {\n  form: any = {\n    login: null,\n    password: null\n  };\n  authenticate = false;\n  isLoginFailed = false;\n  errorMessage = '';\n  role: string = '';\n\n  constructor(private authService: AuthService, private tokenStorage: TokenStorageService) { }\n\n  ngOnInit(): void {\n    if (this.tokenStorage.getToken()) {\n      this.authenticate = true;\n      this.role = this.tokenStorage.getUser().role;\n    }\n  }\n\n  onSubmit(): void {\n    const { login, password } = this.form;\n\n    this.authService.login(login, password).subscribe(\n        (data: { token: any; }) => {\n        this.tokenStorage.saveToken(data.token);\n        this.tokenStorage.saveUser(data);\n\n        this.isLoginFailed = false;\n        this.authenticate = true;\n        this.role = this.tokenStorage.getUser().role;\n        this.reloadPage();\n      },\n        (err: { error: { message: string; }; }) => {\n        debugger;\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n      }\n    );\n  }\n\n  reloadPage(): void {\n    window.location.reload();\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}